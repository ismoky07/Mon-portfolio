{
  "permissions": {
    "allow": [
      "Bash(python -m http.server:*)",
      "Bash(wc:*)",
      "Bash(done)",
      "Bash(find:*)",
      "Bash(dir:*)",
      "Bash(ls:*)",
      "Bash(powershell -File:*)",
      "Bash(powershell:*)",
      "Bash(1 <<'PSEOF'\n$basePath = 'c:\\\\Users\\\\HP\\\\Desktop\\\\Mon_Portfolio\\\\projects'\n$file = 'chatbot-rag-hybride.html'\n$filePath = Join-Path $basePath $file\n$c = [System.IO.File]::ReadAllText\\($filePath\\)\n$c.Contains\\('<!-- Theme \\(anti-flash\\) -->'\\)\n$c.Contains\\('theme-toggle'\\)\n$c.Contains\\('style.css?v=23'\\)\n$c.Contains\\('style.css?v=22'\\)\nPSEOF)",
      "Bash(1 <<'PSEOF'\n$filePath = 'c:\\\\Users\\\\HP\\\\Desktop\\\\Mon_Portfolio\\\\projects\\\\chatbot-rag-hybride.html'\n$content = [System.IO.File]::ReadAllText\\($filePath\\)\n\n# Test replacement 1\n$oldFonts = \"    <!-- Fonts -->\"\n$newFonts = \"    <!-- Theme \\(anti-flash\\) -->`n    <script>`n        \\(function\\(\\) {`n            var theme = localStorage.getItem\\('portfolioTheme'\\) || 'dark';`n            document.documentElement.setAttribute\\('data-theme', theme\\);`n        }\\)\\(\\);`n    </script>`n`n    <!-- Fonts -->\"\n\n$content.Contains\\($oldFonts\\)\n$content = $content.Replace\\($oldFonts, $newFonts\\)\n$content.Contains\\('<!-- Theme \\(anti-flash\\) -->'\\)\n\n# Test replacement 3\n$content = $content.Replace\\('style.css?v=22', 'style.css?v=23'\\)\n$content.Contains\\('style.css?v=23'\\)\nPSEOF)",
      "Bash(1 <<'PSEOF'\n$filePath = 'c:\\\\Users\\\\HP\\\\Desktop\\\\Mon_Portfolio\\\\projects\\\\chatbot-rag-hybride.html'\n$content = [System.IO.File]::ReadAllText\\($filePath\\)\n\n# Replacement 1: Anti-flash theme script before <!-- Fonts -->\n$oldFonts = \"    <!-- Fonts -->\"\n$newFonts = \"    <!-- Theme \\(anti-flash\\) -->`r`n    <script>`r`n        \\(function\\(\\) {`r`n            var theme = localStorage.getItem\\('portfolioTheme'\\) || 'dark';`r`n            document.documentElement.setAttribute\\('data-theme', theme\\);`r`n        }\\)\\(\\);`r`n    </script>`r`n`r`n    <!-- Fonts -->\"\n\n$content = $content.Replace\\($oldFonts, $newFonts\\)\n\n# Replacement 2: Theme toggle button\n$oldNav = \"<button class=\"\"lang-btn\"\" data-lang=\"\"en\"\" title=\"\"English\"\">EN</button>`r`n            </div>`r`n        </div>`r`n    </nav>\"\n$newNav = \"<button class=\"\"lang-btn\"\" data-lang=\"\"en\"\" title=\"\"English\"\">EN</button>`r`n            </div>`r`n            <!-- Theme Toggle -->`r`n            <button class=\"\"theme-toggle\"\" id=\"\"theme-toggle\"\" aria-label=\"\"Toggle theme\"\">`r`n                <i class=\"\"fas fa-moon\"\"></i>`r`n                <i class=\"\"fas fa-sun\"\"></i>`r`n            </button>`r`n        </div>`r`n    </nav>\"\n\n$content = $content.Replace\\($oldNav, $newNav\\)\n\n# Replacement 3: style.css version bump\n$content = $content.Replace\\('style.css?v=22', 'style.css?v=23'\\)\n\n# Write back with UTF-8 no BOM\n$utf8NoBom = New-Object System.Text.UTF8Encoding\\($false\\)\n[System.IO.File]::WriteAllText\\($filePath, $content, $utf8NoBom\\)\n\n# Verify\n$verify = [System.IO.File]::ReadAllText\\($filePath\\)\n$verify.Contains\\('<!-- Theme \\(anti-flash\\) -->'\\)\n$verify.Contains\\('theme-toggle'\\)\n$verify.Contains\\('style.css?v=23'\\)\n$verify.Contains\\('style.css?v=22'\\)\nPSEOF)",
      "Bash(1 <<'PSEOF'\n$files = @\\(\n    'agent-whatsapp.html',\n    'alm-finance.html',\n    'assistant-juridique.html',\n    'automatisation-workflows.html',\n    'correction-automatique.html',\n    'gestion-immobilier.html',\n    'gestion-retraites.html',\n    'gestion-taches-whatsapp.html',\n    'octroi-credit.html',\n    'plateforme-universitaire.html',\n    'recherche-documents-rag.html',\n    'transcription-reunions.html'\n\\)\n\n$basePath = 'c:\\\\Users\\\\HP\\\\Desktop\\\\Mon_Portfolio\\\\projects'\n\n$oldFonts = \"    <!-- Fonts -->\"\n$newFonts = \"    <!-- Theme \\(anti-flash\\) -->`r`n    <script>`r`n        \\(function\\(\\) {`r`n            var theme = localStorage.getItem\\('portfolioTheme'\\) || 'dark';`r`n            document.documentElement.setAttribute\\('data-theme', theme\\);`r`n        }\\)\\(\\);`r`n    </script>`r`n`r`n    <!-- Fonts -->\"\n\n$oldNav = \"<button class=\"\"lang-btn\"\" data-lang=\"\"en\"\" title=\"\"English\"\">EN</button>`r`n            </div>`r`n        </div>`r`n    </nav>\"\n$newNav = \"<button class=\"\"lang-btn\"\" data-lang=\"\"en\"\" title=\"\"English\"\">EN</button>`r`n            </div>`r`n            <!-- Theme Toggle -->`r`n            <button class=\"\"theme-toggle\"\" id=\"\"theme-toggle\"\" aria-label=\"\"Toggle theme\"\">`r`n                <i class=\"\"fas fa-moon\"\"></i>`r`n                <i class=\"\"fas fa-sun\"\"></i>`r`n            </button>`r`n        </div>`r`n    </nav>\"\n\n$utf8NoBom = New-Object System.Text.UTF8Encoding\\($false\\)\n\nforeach \\($file in $files\\) {\n    $filePath = Join-Path $basePath $file\n    $content = [System.IO.File]::ReadAllText\\($filePath\\)\n\n    # Replacement 1\n    if \\($content.Contains\\('<!-- Fonts -->'\\) -and \\(-not $content.Contains\\('<!-- Theme \\(anti-flash\\) -->'\\)\\)\\) {\n        $content = $content.Replace\\($oldFonts, $newFonts\\)\n    }\n\n    # Replacement 2\n    if \\(\\(-not $content.Contains\\('theme-toggle'\\)\\) -and $content.Contains\\($oldNav\\)\\) {\n        $content = $content.Replace\\($oldNav, $newNav\\)\n    }\n\n    # Replacement 3\n    $content = $content.Replace\\('style.css?v=22', 'style.css?v=23'\\)\n\n    [System.IO.File]::WriteAllText\\($filePath, $content, $utf8NoBom\\)\n\n    # Verify\n    $v = [System.IO.File]::ReadAllText\\($filePath\\)\n    $a = $v.Contains\\('<!-- Theme \\(anti-flash\\) -->'\\)\n    $b = $v.Contains\\('theme-toggle'\\)\n    $c = $v.Contains\\('style.css?v=23'\\)\n    $d = $v.Contains\\('style.css?v=22'\\)\n    \"{0}: anti-flash={1}, toggle={2}, v23={3}, v22={4}\" -f $file, $a, $b, $c, $d\n}\nPSEOF)",
      "Bash(1 <<'PSEOF'\n$files = @\\(\n    'agent-whatsapp.html',\n    'alm-finance.html',\n    'assistant-juridique.html',\n    'automatisation-workflows.html',\n    'chatbot-rag-hybride.html',\n    'correction-automatique.html',\n    'gestion-immobilier.html',\n    'gestion-retraites.html',\n    'gestion-taches-whatsapp.html',\n    'octroi-credit.html',\n    'plateforme-universitaire.html',\n    'recherche-documents-rag.html',\n    'transcription-reunions.html'\n\\)\n$basePath = 'c:\\\\Users\\\\HP\\\\Desktop\\\\Mon_Portfolio\\\\projects'\n$results = @\\(\\)\nforeach \\($file in $files\\) {\n    $filePath = Join-Path $basePath $file\n    $v = [System.IO.File]::ReadAllText\\($filePath\\)\n    $a = $v.Contains\\('<!-- Theme \\(anti-flash\\) -->'\\)\n    $b = $v.Contains\\('theme-toggle'\\)\n    $c = $v.Contains\\('style.css?v=23'\\)\n    $d = $v.Contains\\('style.css?v=22'\\)\n    $results += \"$file : anti-flash=$a, toggle=$b, v23=$c, v22=$d\"\n}\n$results\nPSEOF)",
      "Bash(1 <<'PSEOF'\n$filePath = 'c:\\\\Users\\\\HP\\\\Desktop\\\\Mon_Portfolio\\\\projects\\\\chatbot-rag-hybride.html'\n$lines = [System.IO.File]::ReadAllLines\\($filePath\\)\n\nWrite-Output \"=== LINES 7-19 \\(anti-flash theme script + fonts\\) ===\"\nfor \\($i = 6; $i -lt 19; $i++\\) {\n    Write-Output \\(\"{0,3}: {1}\" -f \\($i+1\\), $lines[$i]\\)\n}\n\nWrite-Output \"\"\nWrite-Output \"=== LINES 24-28 \\(style.css version\\) ===\"\nfor \\($i = 23; $i -lt 28; $i++\\) {\n    Write-Output \\(\"{0,3}: {1}\" -f \\($i+1\\), $lines[$i]\\)\n}\n\nWrite-Output \"\"\nWrite-Output \"=== LINES 43-55 \\(theme toggle button\\) ===\"\nfor \\($i = 42; $i -lt 55; $i++\\) {\n    Write-Output \\(\"{0,3}: {1}\" -f \\($i+1\\), $lines[$i]\\)\n}\nPSEOF)",
      "Bash(1 <<'PSEOF'\n$filePath = 'c:\\\\Users\\\\HP\\\\Desktop\\\\Mon_Portfolio\\\\projects\\\\chatbot-rag-hybride.html'\n$lines = [System.IO.File]::ReadAllLines\\($filePath\\)\nWrite-Output \\(\"Total lines: \" + $lines.Length\\)\n\n# Find the theme-toggle line\nfor \\($i = 0; $i -lt $lines.Length; $i++\\) {\n    if \\($lines[$i].Contains\\('theme-toggle'\\)\\) {\n        $start = [Math]::Max\\(0, $i - 5\\)\n        $end = [Math]::Min\\($lines.Length - 1, $i + 8\\)\n        for \\($j = $start; $j -le $end; $j++\\) {\n            Write-Output \\(\"{0,3}: {1}\" -f \\($j+1\\), $lines[$j]\\)\n        }\n        break\n    }\n}\nPSEOF)",
      "Bash(printf:*)"
    ]
  }
}
